(function(t){function e(e){for(var o,s,a=e[0],l=e[1],c=e[2],u=0,d=[];u<a.length;u++)s=a[u],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&d.push(i[s][0]),i[s]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t[o]=l[o]);h&&h(e);while(d.length)d.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],o=!0,s=1;s<n.length;s++){var l=n[s];0!==i[l]&&(o=!1)}o&&(r.splice(e--,1),t=a(a.s=n[0]))}return t}var o={},i={app:0},r=[];function s(t){return a.p+"js/"+({}[t]||t)+"."+{"chunk-0a4ca673":"cec50ee4"}[t]+".js"}function a(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.e=function(t){var e=[],n=i[t];if(0!==n)if(n)e.push(n[2]);else{var o=new Promise((function(e,o){n=i[t]=[e,o]}));e.push(n[2]=o);var r,l=document.createElement("script");l.charset="utf-8",l.timeout=120,a.nc&&l.setAttribute("nonce",a.nc),l.src=s(t);var c=new Error;r=function(e){l.onerror=l.onload=null,clearTimeout(u);var n=i[t];if(0!==n){if(n){var o=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;c.message="Loading chunk "+t+" failed.\n("+o+": "+r+")",c.name="ChunkLoadError",c.type=o,c.request=r,n[1](c)}i[t]=void 0}};var u=setTimeout((function(){r({type:"timeout",target:l})}),12e4);l.onerror=l.onload=r,document.head.appendChild(l)}return Promise.all(e)},a.m=t,a.c=o,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(n,o,function(e){return t[e]}.bind(null,o));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/excel_report/",a.oe=function(t){throw console.error(t),t};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=e,l=l.slice();for(var u=0;u<l.length;u++)e(l[u]);var h=c;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0674":function(t,e,n){"use strict";n.r(e),n.d(e,"globalPolyfill",(function(){return o}));var o=function(){var t=t||window;window&&(window.global=t)}},"56d7":function(t,e,n){"use strict";n.r(e);var o=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"VueXlsx"},[n("v-card",{staticClass:"big-card",attrs:{height:"100%"}},[n("v-tabs",{attrs:{"background-color":"primary",dark:""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},t._l(t.items,(function(e){return n("v-tab",{key:e.tab},[t._v("\n        "+t._s(e.tab)+"\n      ")])})),1),n("v-tabs-items",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},t._l(t.items,(function(t){return n("v-tab-item",{key:t.tab},[n("v-card",{staticClass:"big-card",attrs:{height:"100%"}},[n("v-card-text",[n(t.content,{tag:"component"})],1)],1)],1)})),1)],1)],1)},r=[],s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("section",[n("section",{staticClass:"mb-5"},[n("h2",{staticClass:"mb-5"},[t._v("Import Báo Cáo")]),n("input",{staticClass:"mb-5",attrs:{type:"file"},on:{change:t.onChange}}),n("xlsx-read",{attrs:{file:t.file},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.loading;return[o?n("span",[t._v("Loading...")]):t._e(),n("xlsx-sheets",{scopedSlots:t._u([{key:"default",fn:function(e){var o=e.sheets;return[n("label",{staticStyle:{"margin-right":"5px"}},[t._v("Chọn sheet")]),n("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedSheet,expression:"selectedSheet"}],staticClass:"select-sheet",on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selectedSheet=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:""}},[t._v("Chọn sheet")]),t._l(o,(function(e){return n("option",{key:e,domProps:{value:e}},[t._v("\n                    "+t._s(e)+"\n                  ")])}))],2)]}}],null,!0)}),n("xlsx-json",{attrs:{sheet:t.selectedSheet},on:{parsed:t.updateColecction,table:t.returnTable}})]}}])})],1),n("hr",{staticClass:"mb-5"}),n("h2",{staticClass:"mb-5"},[t._v("Xuất Báo Cáo")]),n("table",{staticClass:"mb-5 table"},[n("thead",[n("tr",[n("th",[t._v(t._s(t.tableTitle))]),n("th",[t._v("Dưới 5")]),n("th",[t._v("Từ 5 đến 6.5")]),n("th",[t._v("Từ 6.5 đến 8")]),n("th",[t._v("Từ 8 đến 10")]),n("th",[t._v("Tổng")])])]),n("tbody",t._l(t.table,(function(e){return n("tr",{key:e.a},[n("td",[t._v(t._s(e.a))]),n("td",[t._v(t._s(e.b))]),n("td",[t._v(t._s(e.c))]),n("td",[t._v(t._s(e.d))]),n("td",[t._v(t._s(e.e))]),n("td",[t._v(t._s(e.f))])])})),0)]),n("xlsx-workbook",[t._l(t.sheets,(function(t){return n("xlsx-sheet",{key:t.name,attrs:{collection:t.data,"sheet-name":t.name}})})),t.jsonFile?n("xlsx-sheet",{attrs:{collection:t.jsonFile,"sheet-name":"fromJson"}}):t._e(),n("xlsx-download",{on:{done:t.updateColecction}},[n("button",{staticClass:"button-77",attrs:{role:"button"}},[t._v("Tải về")])])],2)],1)])},a=[],l=(n("34ef"),n("06db"),n("551c"),n("456d"),n("8a81"),n("d25f"),n("9986"),n("8e6e"),n("96cf"),{data:function(){return{libLoaded:!1,loading:!1}},provide:function(){return{getWorkbook:this.getWorkbook}},methods:{startLoading:function(){this.loading=!0,this.$emit("loading",this.loading)},endLoading:function(){this.loading=!1,this.$emit("loading",this.loading)},fireCallBacks:function(){var t=this;this._callbackQueue&&Array.isArray(this._callbackQueue)&&this._callbackQueue.forEach((function(e){try{e(t._workbook)}catch(n){console.warning("error in firing callbacks",n)}}))},getWorkbook:function(t){this._callbackQueue&&this._callbackQueue.push(t),this._workbook&&t(this._workbook)}}});function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){h(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function h(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d(t,e,n,o,i,r,s){try{var a=t[r](s),l=a.value}catch(c){return void n(c)}a.done?e(l):Promise.resolve(l).then(o,i)}function f(t){return function(){var e=this,n=arguments;return new Promise((function(o,i){var r=t.apply(e,n);function s(t){d(r,o,i,s,a,"next",t)}function a(t){d(r,o,i,s,a,"throw",t)}s(void 0)}))}}var _,p,b={mixins:[l],props:{file:{type:null,default:null},options:{type:Object,default:function(){return{}}}},computed:{loadedAndFile:function(){return this.libLoaded?this.file:null}},watch:{loadedAndFile:{immediate:!0,handler:function(t){t&&this.parseFile(t)}}},mounted:function(){this.load()},methods:{load:function(){var t=this;return f(regeneratorRuntime.mark((function e(){var o,i,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=n("0674"),i=o.globalPolyfill,i(),e.next=4,n.e("chunk-0a4ca673").then(n.t.bind(null,"1146",7));case 4:r=e.sent,s=r.read,t._read=s,t.libLoaded=!0,t._callbackQueue=[];case 9:case"end":return e.stop()}}),e)})))()},parseFile:function(t){var e=this;this.startLoading();var n=new FileReader;n.onload=function(t){for(var n="",o=new Uint8Array(t.target.result),i=o.byteLength,r=0;r<i;r++)n+=String.fromCharCode(o[r]);e._workbook=e._read(n,u({type:"binary"},e.options)),e.fireCallBacks(),e.$emit("parsed",e._workbook),e.endLoading()},n.onerror=function(t){console.log(t)},n.readAsArrayBuffer(t)}},render:function(t){return this.$scopedSlots.default&&this.libLoaded?t("div",[this.$scopedSlots.default({loading:this.loading})]):null}},v=b,m=n("2877"),g=Object(m["a"])(v,_,p,!1,null,null,null),k=g.exports;n("5df3"),n("cadf"),n("ac6a"),n("1c4c"),n("23bf"),n("7f7f");function T(t){return S(t)||x(t)||w(t)||y()}function y(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function w(t,e){if(t){if("string"===typeof t)return C(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(t,e):void 0}}function x(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function S(t){if(Array.isArray(t))return C(t)}function C(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var j,P,F={inject:["getWorkbook"],data:function(){return{innerValue:[]}},mounted:function(){this.getWorkbook(this.parseSheets)},methods:{parseSheets:function(t){this.innerValue=T(t.SheetNames),this.$emit("parsed",T(t.SheetNames))}},render:function(t){return this.$scopedSlots.default?t("div",[this.$scopedSlots.default({sheets:this.innerValue})]):null}},O=F,M=Object(m["a"])(O,j,P,!1,null,null,null),E=M.exports,H=(n("2fdb"),n("6762"),n("c5f6"),n("7cdf"),{inject:["getWorkbook"],props:{sheet:{type:[String,Number],default:0},options:{type:Object,default:function(){return{}}}},data:function(){return{loaded:!1}},computed:{loadedAndSheet:function(){return this.loaded?this.sheet:null}},watch:{loadedAndSheet:{immediate:!0,handler:function(t){null!==t&&this.getWorkbook(this._callBack)}}},mounted:function(){this._callBack=function(){console.warning("Missing data parsing callback")}},methods:{sheetNameFinder:function(t){return Number.isInteger(this.sheet)?t.SheetNames[this.sheet]:this.sheet}}});function $(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A(t,e,n,o,i,r,s){try{var a=t[r](s),l=a.value}catch(c){return void n(c)}a.done?e(l):Promise.resolve(l).then(o,i)}function Y(t){return function(){var e=this,n=arguments;return new Promise((function(o,i){var r=t.apply(e,n);function s(t){A(r,o,i,s,a,"next",t)}function a(t){A(r,o,i,s,a,"throw",t)}s(void 0)}))}}var N,L,D={mixins:[H],data:function(){return{collection:null}},mounted:function(){this._callBack=this.updateJson,this.load()},methods:{load:function(){var t=this;return Y(regeneratorRuntime.mark((function e(){var o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n.e("chunk-0a4ca673").then(n.t.bind(null,"1146",7));case 2:o=e.sent,i=o.utils.sheet_to_json,t._sheet_to_json=i,t.loaded=!0;case 6:case"end":return e.stop()}}),e)})))()},updateJson:function(t){var e=t.Sheets[this.sheetNameFinder(t)];this.collection=this._sheet_to_json(e,this.options);var n=!1;if(this.collection.length<3){var o=[{}];return n=!0,this.$emit("parsed",o),this.$emit("table",{returnTable:H,title:"Cuộc thi",saiMau:n}),!1}var i=this.collection[3];if("Điểm trung bình cuộc thi"===i["__EMPTY_9"]&&"Thiết bị thi mới nhất"===i["__EMPTY_8"]){var r,s,a,l,c,u,h,d=[],f=[],_=[],p=[];console.log(e),console.log(this.collection);for(var b=0,v=0,m=0,g=0,k=0,T=0,y=0,w=0,x=0,S=0,C=0,j=0,P=4;P<this.collection.length;P++){var F=this.collection[P];F["__EMPTY_9"]<5||"-"==F["__EMPTY_9"]?(d.push(F),F["__EMPTY_8"]?F["__EMPTY_8"].includes("Desktop")?b++:k++:x++):F["__EMPTY_9"]>=5&&F["__EMPTY_9"]<6.5?(f.push(F),F["__EMPTY_8"]?F["__EMPTY_8"].includes("Desktop")?v++:T++:S++):F["__EMPTY_9"]>=6.5&&F["__EMPTY_9"]<8?(_.push(F),F["__EMPTY_8"]?F["__EMPTY_8"].includes("Desktop")?m++:y++:C++):F["__EMPTY_9"]>=8&&F["__EMPTY_9"]<=10&&(p.push(F),F["__EMPTY_8"]?F["__EMPTY_8"].includes("Desktop")?g++:w++:j++)}var O=this.collection[1],M=O["THỐNG KÊ KẾT QUẢ CHI TIẾT HỌC VIÊN THAM GIA CUỘC THI"],E=[(r={},$(r,M,"Số thí sinh"),$(r,"Dưới 5:",d.length+" Học sinh"),$(r,"Từ 5 đến 6.5:",f.length+" Học sinh"),$(r,"Từ 6.5 đến 8:",_.length+" Học sinh"),$(r,"Từ 8 đến 10:",p.length+" Học sinh"),$(r,"Tổng:",d.length+_.length+p.length+f.length+" Học sinh"),r),(s={},$(s,M,"Tỉ lệ %"),$(s,"Dưới 5:",parseFloat(d.length/(this.collection.length-4)*100).toFixed(2)+"%"),$(s,"Từ 5 đến 6.5:",parseFloat(f.length/(this.collection.length-4)*100).toFixed(2)+"%"),$(s,"Từ 6.5 đến 8:",parseFloat(_.length/(this.collection.length-4)*100).toFixed(2)+"%"),$(s,"Từ 8 đến 10:",parseFloat(p.length/(this.collection.length-4)*100).toFixed(2)+"%"),$(s,"Tổng:","100%"),s),(a={},$(a,M,"Làm trên máy tính"),$(a,"Dưới 5:",b+" Học sinh"),$(a,"Từ 5 đến 6.5:",v+" Học sinh"),$(a,"Từ 6.5 đến 8:",m+" Học sinh"),$(a,"Từ 8 đến 10:",g+" Học sinh"),$(a,"Tổng:",b+v+m+g),a),(l={},$(l,M,"Tỉ lệ Làm trên máy tính"),$(l,"Dưới 5:",parseFloat(b/(this.collection.length-4)*100).toFixed(2)+"%"),$(l,"Từ 5 đến 6.5:",parseFloat(v/(this.collection.length-4)*100).toFixed(2)+"%"),$(l,"Từ 6.5 đến 8:",parseFloat(m/(this.collection.length-4)*100).toFixed(2)+"%"),$(l,"Từ 8 đến 10:",parseFloat(g/(this.collection.length-4)*100).toFixed(2)+"%"),$(l,"Tổng:",parseFloat((b+v+m+g)/(this.collection.length-4)*100).toFixed(2)+"%"),l),(c={},$(c,M,"Làm trên điện thoại"),$(c,"Dưới 5:",k+" Học sinh"),$(c,"Từ 5 đến 6.5:",T+" Học sinh"),$(c,"Từ 6.5 đến 8:",y+" Học sinh"),$(c,"Từ 8 đến 10:",w+" Học sinh"),$(c,"Tổng:",k+T+y+w),c),(u={},$(u,M,"Tỉ lệ Làm trên máy tính"),$(u,"Dưới 5:",parseFloat(k/(this.collection.length-4)*100).toFixed(2)+"%"),$(u,"Từ 5 đến 6.5:",parseFloat(T/(this.collection.length-4)*100).toFixed(2)+"%"),$(u,"Từ 6.5 đến 8:",parseFloat(y/(this.collection.length-4)*100).toFixed(2)+"%"),$(u,"Từ 8 đến 10:",parseFloat(w/(this.collection.length-4)*100).toFixed(2)+"%"),$(u,"Tổng:",parseFloat((k+T+y+w)/(this.collection.length-4)*100).toFixed(2)+"%"),u),(h={},$(h,M,"Không xác định thiết bị"),$(h,"Dưới 5:",x),$(h,"Từ 5 đến 6.5:",S),$(h,"Từ 6.5 đến 8:",C),$(h,"Từ 8 đến 10:",j),h)],H=[{a:"Số học sinh",b:d.length+" Học sinh",c:f.length+" Học sinh",d:_.length+" Học sinh",e:p.length+" Học sinh",f:d.length+f.length+_.length+p.length+" Học sinh"},{a:"Tỉ lệ",b:parseFloat(d.length/(this.collection.length-4)*100).toFixed(2)+"%",c:parseFloat(f.length/(this.collection.length-4)*100).toFixed(2)+"%",d:parseFloat(_.length/(this.collection.length-4)*100).toFixed(2)+"%",e:parseFloat(p.length/(this.collection.length-4)*100).toFixed(2)+"%",f:"100%"},{a:"Số lượng làm trên máy tính",b:b+" Học sinh",c:v+" Học sinh",d:m+" Học sinh",e:g+" Học sinh",f:b+v+m+g+" Học sinh"},{a:"Số lượng làm trên điện thoại",b:k+" Học sinh",c:T+" Học sinh",d:y+" Học sinh",e:w+" Học sinh",f:k+T+y+w+" Học sinh"},{a:"Số lượng thiết bị không xác định",b:x,c:S,d:C,e:j,f:x+S+C+j}];this.$emit("parsed",E);var A={returnTable:H,title:M};this.$emit("table",A)}else{n=!0;var Y=[{}];this.$emit("parsed",Y),this.$emit("table",{returnTable:H,title:"Cuộc thi",saiMau:n})}}},render:function(t){return this.$scopedSlots.default&&this.loaded?t("div",[this.$scopedSlots.default({collection:this.collection})]):null}},V=D,R=Object(m["a"])(V,N,L,!1,null,null,null),B=R.exports;function I(t,e,n,o,i,r,s){try{var a=t[r](s),l=a.value}catch(c){return void n(c)}a.done?e(l):Promise.resolve(l).then(o,i)}function W(t){return function(){var e=this,n=arguments;return new Promise((function(o,i){var r=t.apply(e,n);function s(t){I(r,o,i,s,a,"next",t)}function a(t){I(r,o,i,s,a,"throw",t)}s(void 0)}))}}var X,J,Q={mixins:[l],provide:function(){return{addSheet:this.addSheet,deleteSheet:this.deleteSheet}},mounted:function(){this.load()},methods:{load:function(){var t=this;return W(regeneratorRuntime.mark((function e(){var o,i,r,s,a,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=n("0674"),i=o.globalPolyfill,i(),e.next=4,n.e("chunk-0a4ca673").then(n.t.bind(null,"1146",7));case 4:r=e.sent,s=r.utils,a=s.book_new,l=s.book_append_sheet,t._book_new=a,t._book_append_sheet=l,t._workbook=t._book_new(),t.$emit("created",t._workbook),t.libLoaded=!0;case 13:case"end":return e.stop()}}),e)})))()},addSheet:function(t,e){this._workbook&&(this.deleteSheet(e),this._book_append_sheet(this._workbook,t,e),this.$emit("change",this._workbook))},deleteSheet:function(t){this._workbook&&this._workbook.Sheets[t]&&(this._workbook.SheetNames=this._workbook.SheetNames.filter((function(e){return e!==t})),this._workbook.Sheets[t]=void 0,this.$emit("change",this._workbook))}},render:function(t){return this.$slots.default&&this.libLoaded?t("div",this.$slots.default):null}},G=Q,U=Object(m["a"])(G,X,J,!1,null,null,null),q=U.exports,K=function(t){return t instanceof Array?"array":t instanceof Object&&"object"},z=function(t){return t.reduce((function(t,e){return null===t?K(e):K(e)===t&&t}),null)};function Z(t,e,n,o,i,r,s){try{var a=t[r](s),l=a.value}catch(c){return void n(c)}a.done?e(l):Promise.resolve(l).then(o,i)}function tt(t){return function(){var e=this,n=arguments;return new Promise((function(o,i){var r=t.apply(e,n);function s(t){Z(r,o,i,s,a,"next",t)}function a(t){Z(r,o,i,s,a,"throw",t)}s(void 0)}))}}var et,nt,ot={inject:["getWorkbook","addSheet","deleteSheet"],props:{sheetName:{type:String,required:!0},collection:{type:Array,default:null,validator:function(t){if(t&&t.length>0){var e=z(t);return["array","object"].includes(e)}return!0}}},data:function(){return{libLoaded:!1}},computed:{readyToParse:function(){return this.libLoaded?this.collection:null}},watch:{readyToParse:{immediate:!0,handler:function(t){t&&this.parseCollection(t)}}},mounted:function(){this.load()},beforeDestroy:function(){this.deleteSheet(this.sheetName)},methods:{load:function(){var t=this;return tt(regeneratorRuntime.mark((function e(){var o,i,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n.e("chunk-0a4ca673").then(n.t.bind(null,"1146",7));case 2:o=e.sent,i=o.utils,r=i.aoa_to_sheet,s=i.json_to_sheet,t._aoa_to_sheet=r,t._json_to_sheet=s,t.libLoaded=!0,t.getWorkbook((function(e){t._workbook=e}));case 10:case"end":return e.stop()}}),e)})))()},parseCollection:function(t){var e=K(t[0]),n={array:this._aoa_to_sheet,object:this._json_to_sheet};this._sheet=n[e](t,this.options),this.$emit("parsed",this._sheet),this.addSheet(this._sheet,this.sheetName)}},render:function(t){return this.$slots.default&&this.libLoaded?t("div",this.$slots.default):null}},it=ot,rt=Object(m["a"])(it,et,nt,!1,null,null,null),st=rt.exports;function at(t,e,n,o,i,r,s){try{var a=t[r](s),l=a.value}catch(c){return void n(c)}a.done?e(l):Promise.resolve(l).then(o,i)}function lt(t){return function(){var e=this,n=arguments;return new Promise((function(o,i){var r=t.apply(e,n);function s(t){at(r,o,i,s,a,"next",t)}function a(t){at(r,o,i,s,a,"throw",t)}s(void 0)}))}}var ct,ut,ht={inject:["getWorkbook"],props:{filename:{type:String,default:"tong_quan_ki_thi.xlsx"},options:{type:Object,default:function(){return{}}},disableWrapperClick:{type:Boolean,default:!1}},data:function(){return{loaded:!1}},mounted:function(){this.load()},watch:{loaded:{immediate:!0,handler:function(t){var e=this;t&&this.getWorkbook((function(t){e._workbook=t}))}}},methods:{load:function(){var t=this;return lt(regeneratorRuntime.mark((function e(){var o,i,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n.e("chunk-0a4ca673").then(n.t.bind(null,"1146",7));case 2:return o=e.sent,i=o.writeFile,t._writeFile=i,e.next=7,n.e("chunk-0a4ca673").then(n.t.bind(null,"1146",7));case 7:r=e.sent,s=r.utils.json_to_sheet,t.json_to_sheet=s,t.loaded=!0;case 11:case"end":return e.stop()}}),e)})))()},download:function(){var t=this._workbook.Sheets["Dữ liệu"];t["!cols"]=[{width:60},{width:20},{width:20},{width:20},{width:20}],this._writeFile(this._workbook,this.filename,this.options),this.$emit("done",{})}},render:function(t){return this.$scopedSlots.default&&this.loaded?t("div",{on:{click:this.disableWrapperClick?function(){}:this.download}},[this.$scopedSlots.default({download:this.download})]):null}},dt=ht,ft=Object(m["a"])(dt,ct,ut,!1,null,null,null),_t=ft.exports,pt={components:{XlsxRead:k,XlsxSheets:E,XlsxJson:B,XlsxWorkbook:q,XlsxSheet:st,XlsxDownload:_t},watch:{saiMau:function(){this.saiMau&&(alert("Sai mẫu Excel !!!!"),this.sheets=[])}},data:function(){return{file:null,selectedSheet:null,sheetName:"Dữ liệu",sheets:[],collection:[],jsonFile:null,table:[],tableTitle:"Cuộc thi",saiMau:!1}},methods:{onChange:function(t){this.file=t.target.files?t.target.files[0]:null,this.collection=[],this.table=[],this.sheets=[],this.saiMau=!1,this.tableTitle="Cuộc Thi"},onJsonFileChange:function(t){var e=this,n=new FileReader;n.onload=function(t){console.log(e.jsonFile),e.jsonFile=JSON.parse(t.target.result)},n.readAsText(t.target.files[0])},updateColecction:function(t){this.collection=t,this.sheets=[],this.addSheet()},returnTable:function(t){this.table=t.returnTable,this.tableTitle=t.title,this.saiMau=t.saiMau},addSheet:function(){this.sheets.push({name:this.sheetName,data:this.collection})}}},bt=pt,vt=Object(m["a"])(bt,s,a,!1,null,null,null),mt=vt.exports,gt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("section",[n("section",{staticClass:"mb-5"},[n("h2",{staticClass:"mb-5"},[t._v("Import Báo Cáo")]),n("input",{staticClass:"mb-5",attrs:{type:"file"},on:{change:t.onChange}}),n("xlsx-read",{attrs:{file:t.file},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.loading;return[o?n("span",[t._v("Loading...")]):t._e(),n("xlsx-sheets",{scopedSlots:t._u([{key:"default",fn:function(e){var o=e.sheets;return[n("label",{staticStyle:{"margin-right":"5px"}},[t._v("Chọn sheet")]),n("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedSheet,expression:"selectedSheet"}],staticClass:"select-sheet",on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selectedSheet=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:""}},[t._v("Chọn sheet")]),t._l(o,(function(e){return n("option",{key:e,domProps:{value:e}},[t._v("\n                  "+t._s(e)+"\n                ")])}))],2)]}}],null,!0)}),n("xlsx-json",{attrs:{sheet:t.selectedSheet},on:{parsed:t.updateColecction,table:t.returnTable}})]}}])})],1),n("hr",{staticClass:"mb-5"}),n("h2",{staticClass:"mb-5"},[t._v("Xuất Báo Cáo")]),n("table",{staticClass:"mb-5 table"},[n("thead",[n("tr",[n("th",[t._v(t._s(t.tableTitle))]),n("th",[t._v("Tổng số học sinh")]),n("th",[t._v("Có tham gia thi")]),n("th",[t._v("Vắng thi")])])]),n("tbody",t._l(t.table,(function(e){return n("tr",{key:e.a},[n("td",[t._v(t._s(e.a))]),n("td",[t._v(t._s(e.b))]),n("td",[t._v(t._s(e.c))]),n("td",[t._v(t._s(e.d))])])})),0)]),n("h2",{staticClass:"mb-5"},[t._v("Danh sách vắng")]),n("table",{staticClass:"mb-5 table"},[t._m(0),n("tbody",t._l(t.listVangThi,(function(e,o){return n("tr",{key:e.__EMPTY_2},[n("td",[t._v(t._s(o+1))]),n("td",[t._v(t._s(e.__EMPTY_2))]),n("td",[t._v(t._s(e.__EMPTY+"Vòng thi: "+e.__EMPTY_1))]),n("td",[t._v(t._s(e.__EMPTY_4))])])})),0)]),n("xlsx-workbook",[t._l(t.sheets,(function(t){return n("xlsx-sheet",{key:t.name,attrs:{collection:t.data,"sheet-name":t.name}})})),t.jsonFile?n("xlsx-sheet",{attrs:{collection:t.jsonFile,"sheet-name":"fromJson"}}):t._e(),n("xlsx-download",{on:{done:t.updateColecction}},[n("button",{staticClass:"button-77",attrs:{role:"button"}},[t._v("Tải về")])])],2)],1)])},kt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("tr",[n("th",[t._v("Số thứ tự")]),n("th",[t._v("Họ tên")]),n("th",[t._v("Cuộc thi")]),n("th",[t._v("Lớp")])])])}];function Tt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yt(t,e,n,o,i,r,s){try{var a=t[r](s),l=a.value}catch(c){return void n(c)}a.done?e(l):Promise.resolve(l).then(o,i)}function wt(t){return function(){var e=this,n=arguments;return new Promise((function(o,i){var r=t.apply(e,n);function s(t){yt(r,o,i,s,a,"next",t)}function a(t){yt(r,o,i,s,a,"throw",t)}s(void 0)}))}}var xt,St,Ct={mixins:[H],data:function(){return{collection:null}},mounted:function(){this._callBack=this.updateJson,this.load()},methods:{load:function(){var t=this;return wt(regeneratorRuntime.mark((function e(){var o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n.e("chunk-0a4ca673").then(n.t.bind(null,"1146",7));case 2:o=e.sent,i=o.utils.sheet_to_json,t._sheet_to_json=i,t.loaded=!0;case 6:case"end":return e.stop()}}),e)})))()},updateJson:function(t){var e=t.Sheets[this.sheetNameFinder(t)];this.collection=this._sheet_to_json(e,this.options);var n=!1,o=[];if(this.collection.length<3){var i=[{}];return this.$emit("parsed",i),this.$emit("table",{returnTable:k,title:"Cuộc thi"}),!1}console.log(this.collection);var r=this.collection[2];if("Cuộc thi"!==r["__EMPTY"]||"Trạng thái"!==r["__EMPTY_5"]){n=!0;var s=[{}];return this.$emit("parsed",s),this.$emit("table",{returnTable:k,title:"Cuộc thi",saiMau:n}),!1}for(var a,l,c,u=this.collection.length-3,h=0,d=0,f=3;f<this.collection.length;f++){var _=this.collection[f];"Đã thi"==_["__EMPTY_5"]?h++:"Chưa thi"==_["__EMPTY_5"]&&(d++,o.push(_))}for(var p="THỐNG KÊ HỌC VIÊN THAM GIA CUỘC THI",b=[(a={},Tt(a,p,"Thống kê"),Tt(a,"Tổng số",u),Tt(a,"Tham gia thi:",h),Tt(a,"Vắng thi:",d),a),(l={},Tt(l,p,"DANH SÁCH THÍ SINH VẮNG"),Tt(l,"Tổng số",""),Tt(l,"Tham gia thi:",""),Tt(l,"Vắng thi:",""),l),(c={},Tt(c,p,"Số thứ tự"),Tt(c,"Tổng số","Họ tên"),Tt(c,"Tham gia thi:","Cuộc thi"),Tt(c,"Vắng thi:","Lớp"),c)],v=0;v<o.length;v++){var m,g=(m={},Tt(m,p,v+1),Tt(m,"Tổng số",o[v].__EMPTY_2),Tt(m,"Tham gia thi:",o[v].__EMPTY),Tt(m,"Vắng thi:",o[v].__EMPTY_4),m);b.push(g)}var k=[{a:"Thống kê",b:u,c:h,d:d}];this.$emit("parsed",b);var T={returnTable:k,title:p,saiMau:n,listVangThi:o};this.$emit("table",T)}},render:function(t){return this.$scopedSlots.default&&this.loaded?t("div",[this.$scopedSlots.default({collection:this.collection})]):null}},jt=Ct,Pt=Object(m["a"])(jt,xt,St,!1,null,null,null),Ft=Pt.exports,Ot={components:{XlsxRead:k,XlsxSheets:E,XlsxJson:Ft,XlsxWorkbook:q,XlsxSheet:st,XlsxDownload:_t},data:function(){return{file:null,selectedSheet:null,sheetName:"Dữ liệu",sheets:[],collection:[],jsonFile:null,table:[],tableTitle:"Cuộc thi",saiMau:!1,listVangThi:[]}},watch:{saiMau:function(){this.saiMau&&(this.sheets=[],alert("Sai mẫu Excel !!!!"))}},methods:{onChange:function(t){this.file=t.target.files?t.target.files[0]:null,this.collection=[],this.table=[],this.sheets=[],this.saiMau=!1,this.tableTitle="Cuộc Thi"},onJsonFileChange:function(t){var e=this,n=new FileReader;n.onload=function(t){console.log(e.jsonFile),e.jsonFile=JSON.parse(t.target.result)},n.readAsText(t.target.files[0])},updateColecction:function(t){this.collection=t,this.sheets=[],this.addSheet()},returnTable:function(t){this.table=t.returnTable,this.tableTitle=t.title,this.saiMau=t.saiMau,this.listVangThi=t.listVangThi},addSheet:function(){this.sheets.push({name:this.sheetName,data:this.collection})}}},Mt=Ot,Et=Object(m["a"])(Mt,gt,kt,!1,null,null,null),Ht=Et.exports,$t={components:{BAOCAO1:mt,BAOCAO2:Ht},data:function(){return{tableTitle:"Cuộc thi",tab:null,items:[{tab:"Thống kê kết quả thi",content:"BAOCAO1"},{tab:"Thống kê tham gia thi",content:"BAOCAO2"}]}},methods:{}},At=$t,Yt=Object(m["a"])(At,i,r,!1,null,null,null),Nt=Yt.exports,Lt=n("ce5b"),Dt=n.n(Lt);n("bf40");o["default"].use(Dt.a);var Vt={},Rt=new Dt.a(Vt);o["default"].config.productionTip=!1,new o["default"]({vuetify:Rt,render:function(t){return t(Nt)}}).$mount("#app")}});
//# sourceMappingURL=app.f59ed49b.js.map